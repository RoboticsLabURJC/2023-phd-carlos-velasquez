---
title: Week 70 - Mejora del proceso de generación del dataset
categories:
    - weekly Log
tags:
    - CARLA Simulator
    - ROS 2
    - Python
---

Mejora del proceso de generación del dataset

Se optimizó el script de creación del dataset para resolver los problemas de desfase temporal que se presentaban al etiquetar imágenes en tiempo real, debido a la latencia en el guardado de cada fotograma.
El nuevo flujo busca mejorar la sincronización entre las imágenes y los comandos de control (steer, throttle, brake), asegurando que ambos correspondan al mismo instante de simulación.

El proceso se dividió en dos etapas independientes:

1. **Etapa A**– Registro de la simulación:
Se ejecuta la simulación y se genera un archivo .log con toda la información del entorno (posiciones, actores, frame_id, etc.), junto con un archivo .csv que almacena los comandos de control aplicados por el piloto o el modelo durante cada tick de simulación.

2. **Etapa B** – Recuperación y sincronización:
A partir del archivo .log, se reproduce la simulación (replay) en modo síncrono. Durante esta reproducción se:

      + Capturan las imágenes segmentadas desde los sensores.
      + Se realiza la inferencia de curvatura utilizando un modelo EfficientNet entrenado previamente.
      + Se sincronizan las imágenes recuperadas con los comandos de control registrados en el .csv, unificando toda la información en un nuevo archivo labels.csv.

Esta separación de etapas permite un control más preciso sobre el tiempo de captura y almacenamiento, garantizando que cada imagen esté correctamente asociada a los valores de control que se aplicaron en el mismo instante del tick de simulación.