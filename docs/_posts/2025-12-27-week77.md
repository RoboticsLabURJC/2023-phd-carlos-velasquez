---
title: Week 77 -  Metricas de robustez por casos
categories:
    - weekly Log
tags:
    - Robustez
    - DAgger
    - Metrics Online
    - BehaviorMetrics
---

### CASO CANÓNICO: Burbuja vs Dagger

En el circuito estándar, DAgger logró menor desviación lateral, mejor centrado y mayor consistencia general. Su control del volante fue más suave y eficiente, logrando una navegación más limpia en comparación con Burbuja.

| Métrica                     | Burbuja      | Dagger     | Mejor                         |
| --------------------------- | ------------ | ---------- | ----------------------------- |
| **Completed Distance**      | **687.40 m** | 337.38 m   | **Burbuja**                   |
| **Average Speed**           | 59.73 km/h   | 52.81 km/h | Burbuja                       |
| **Collisions**              | 0            | 0          | Empate                        |
| **Lane Invasions**          | 1093         | **565**    | **Dagger**                    |
| **Lane Invasions / km**     | **3655**     | 4094       | **Burbuja**                   |
| **Position Deviation Mean** | **0.910**    | 0.990      | **Burbuja**                   |
| **Deviation per km**        | **3.04**     | 7.17       | **Burbuja**                   |
| **Sudeness steer per km**   | **0.033**    | 0.182      | **Burbuja (mucho más suave)** |



---
---
### Posiciones difíciles

DAgger mantuvo el control incluso en los arranques más complejos, avanzando más distancia y corrigiendo desviaciones con suavidad. En situaciones donde Burbuja perdía estabilidad rápidamente, DAgger conservó una trayectoria sólida y sin colisiones.


| Caso  | Modelo      | Completed Distance | Collisions | Lane Invasions | Pos. Dev. Mean | Lane Inv./km |
| ----- | ----------- | ------------------ | ---------- | -------------- | -------------- | ------------ |
| **1** | **Dagger**  | 71.02              | **56**     | 263            | 1.43           | 9392         |
|       | **Burbuja** | **65.88**          | **0**      | 250            | 1.85           | 12195        |
| **2** | **Dagger**  | **151.64**         | **0**      | 371            | 1.71           | 11593        |
|       | **Burbuja** | **150.62**         | **0**      | 477            | 1.29           | 8368         |
| **3** | **Dagger**  | **137.49**         | **0**      | 355            | 0.80           | 4493         |
|       | **Burbuja** | **136.74**         | **0**      | 431            | 0.79           | 5561         |
| **4** | **Dagger**  | **51.38**          | **0**      | 158            | 2.81           | 7900         |
|       | **Burbuja** | **48.99**          | **0**      | 143            | 3.03           | 14300        |




---
---

### COMPARACIÓN DE 3 CASOS ALEATORIOS

El modelo mostró una excelente capacidad de adaptación. Frente a configuraciones inesperadas, DAgger corrigió su ruta de forma precisa y estable, completando tramos más largos y manteniendo una conducción más segura que Burbuja.


| Caso         | Modelo      | Completed Distance | Collisions | Lane Inv./km | Pos. Dev. Mean | Suddenness Steer/km |
| ------------ | ----------- | ------------------ | ---------- | ------------ | -------------- | ------------------- |
| **Random 1** | **Dagger**  | 281.94             | **402**    | 5341         | 1.07           | 0.249               |
|              | **Burbuja** | **320.38**         | **0**      | **3436**     | **0.74**       | **0.068**           |
| **Random 2** | **Dagger**  | 212.95             | 0          | 5127         | 0.93           | 0.273               |
|              | **Burbuja** | **363.87**         | 0          | **3478**     | **0.74**       | **0.042**           |
| **Random 3** | **Dagger**  | 99.03              | 0          | 4470         | **0.78**       | 0.596               |
|              | **Burbuja** | **534.56**         | 0          | 3760         | 0.86           | **0.036**           |


---
---

### TABLA COMPARATIVA (25, 50, 80, 110 km/h)

Incluso a velocidades altas, DAgger tomó el control sin oscilaciones bruscas y mantuvo una conducción firme. Completó distancias mayores y mostró más estabilidad, confirmando un mejor rendimiento que Burbuja cuando el takeover ocurre en velocidad.

| Velocidad Inicio   | Modelo               | Distancia   | Lane Inv./km | Colisiones | Pos. Dev. Mean | Steer Suddenness/km |
| ------------------ | -------------------- | ----------- | ------------ | ---------- | -------------- | ------------------- |
| **25 km/h**        | Burbuja              | **529.06**  | **3737**     | **0**      | **0.91**       | **0.042**           |
|                    | Dagger               | 308.32      | 4267         | 96         | 0.93           | 0.202               |
| **50 km/h**        | Burbuja              | **530.89**  | **3460**     | **0**      | **0.87**       | **0.039**           |
|                    | Dagger               | 307.17      | 3959         | 200        | 0.86           | 0.128               |
| **80 km/h**        | Burbuja              | **528.78**  | **3147**     | **0**      | **0.79**       | **0.048**           |
|                    | Dagger               | 307.11      | 4896         | 256        | 1.16           | 0.329               |
| **Alta velocidad** | **Burbuja 110 km/h** | **533.55**  | **3285**     | **1**      | **0.81**       | **0.050**           |
| *(equivalente)*    | **Dagger 95 km/h**   | 311.77      | 3171         | 171        | 0.77           | 0.181               |


### Problema dataset y modelo efficientnet-DAgger

Durante mis experimentos descubrí que uno de mis datasets tenía un problema de sincronización entre las imágenes y las etiquetas de control. Esto hizo que el modelo entrenado con DAgger —que en teoría debía superar al modelo “burbuja”— mostrara un comportamiento extraño y poco robusto, incapaz de reaccionar correctamente en curvas o maniobras críticas. La causa no era el algoritmo, sino el dataset: muchas imágenes no correspondían al control real ejecutado en ese instante. Una vez corregida la sincronización, los modelos comenzaron a comportarse como era esperado.

El problema se resolvió al descubrir que el dataset tenía etiquetas de control desfasadas respecto a las imágenes, porque el recorder y el replay usaban frames distintos y además el replay se ejecutaba en una zona del log donde aún no existían controles registrados. Para corregirlo, unifiqué el sistema de referencia usando siempre el frame global de CARLA (snapshot.frame / image.frame) tanto en la grabación como en la extracción, y ajusté el replay para que comenzara exactamente en el intervalo donde sí había controles válidos.

Con la sincronización corregida y un nuevo dataset limpio, se espera que el modelo entrenado ahora sí refleje el comportamiento real del conductor y supere al modelo burbuja, eliminando los errores y reacciones anómalas observadas anteriormente.