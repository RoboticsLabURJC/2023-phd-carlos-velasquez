---
title: Week 71 - Reconstrucción del dataset y nuevo pipeline de sincronización
categories:
    - weekly Log
tags:
    - CARLA Simulator
    - ROS 2
    - Python
---

### Reconstrucción del dataset y nuevo pipeline de sincronización

Esta semana reconstruí completamente el dataset para el modelo de conducción. Grabé escenarios variados en CARLA y dejé Town02 solo para test, para asegurar una prueba “real” sin contaminación del entrenamiento.

Con la Python API generé unas 87.000 imágenes RGB y segmentadas. Luego balanceé el dataset (steer y throttle) hasta dejarlo en unas 85.000 muestras, usando remuestreo para evitar que el modelo aprenda solo a manejar en recto.

#### **Nuevo pipeline (mucho más estable)**

Antes intentaba guardar imágenes y comandos en tiempo real, pero eso genera jitter: las imágenes tardan en escribirse y pierden sincronía con los comandos.
Para solucionarlo, ahora el proceso se hace en tres pasos separados:

1. **Grabar la simulación**
Solo guardo el log con posiciones, frame ID y comandos del vehículo.

2. **Reproducir y capturar imágenes**
Uso client.replay_file() para repetir la simulación de forma determinista y ahí sí capturo las imágenes RGB y segmentadas sin afectar el tiempo.

3. **Inferir curvatura**
Con todas las imágenes ya sincronizadas, paso un modelo especializado para generar la etiqueta de curvatura.

De esta forma no hay retrasos ni desfases entre lo que el piloto hizo y las imágenes que se usaron para entrenar.


test offline en Town02 en proceso...