---
title: Week 58 - Sincronización de tópicos
categories:
    - weekly Log
tags:
    - CARLA Simulator
    - ROS 2
    - Python
---


### Estadísticas de la inferencia

| Métrica             | Valor Aprox. |
| ------------------- | ------------ |
| Promedio            | \~3.6 ms     |
| Mediana             | \~3.1 ms     |
| Máximo              | \~8.1 ms     |
| Desviación estándar | \~1.1 ms     |


### **Posible causa de fallos**
En otros experimentos, se observaron picos de latencia como:
* Inferencia máxima: 713 ms
* Esto causó desincronización: los ticks se acumularon y el control se retrasó.

¿Qué causó esto?
* El primer forward del modelo (warm-up) suele ser mucho más lento.
* Sin warm-up previo, esta primera inferencia rompe el ritmo del simulador.
* También puede deberse a una sobrecarga momentánea de CPU/GPU.

### **Soluciones aplicadas**
* Se implementó un warm-up manual con 5 inferencias simuladas (np.random.rand) antes de comenzar a medir.
* Se verificó el uso de GPU (CUDAExecutionProvider).

Al aplicar warm-up, las inferencias se mantuvieron consistentes y rápidas, permitiendo mantener la sincronía tick-a-tick en modo síncrono a 20 Hz con CARLA.


### **Prueba de modelo ONNX: EfficientNetV2-S en CARLA**

| Métrica                          | Valor      |
| -------------------------------- | ---------- |
| Tiempo total simulado (CARLA)    | 63 s       |
| Tiempo real total                | 273.67 s   |
| Distancia completada             | 780.14 m   |
| Distancia efectiva en ruta       | 256.0 m    |
| Velocidad promedio               | 44.87 km/h |
| Velocidad máxima                 | 66.77 km/h |
| Velocidad mínima                 | 25.19 km/h |
| Colisiones                       | 0          |
| Invasiones de carril             | 0          |
| Desviación media respecto a ruta | 0.873 m    |
| Desviación total acumulada       | 733.55 m   |
| Desviación media por kilómetro   | 3.41 m/km  |



<figure class="half">
  <img src="{{ site.url }}{{ site.baseurl }}/assets/images/week58/mapa.png" alt="Town02 Metrics Map" style="width:100%">
  <figcaption>Town02 metrics map</figcaption>
</figure>